# ===================================================================
# COMMON CONFIGURATION (APPLIES TO ALL ENVIRONMENTS)
# ===================================================================
spring.application.name=xamops-service
server.port=8080

# --- Set the default profile to 'local' if no other profile is specified ---
spring.profiles.active=local

# --- Common JPA & Database Driver ---
# ==============================================================
# MASTER DATABASE CONFIGURATION (production_db)
# ==============================================================
spring.datasource.url=jdbc:postgresql://3.110.102.128:5432/production_db
spring.datasource.username=app_user
spring.datasource.password=AppPassword123
spring.datasource.driver-class-name=org.postgresql.Driver
spring.jpa.database-platform=org.hibernate.dialect.PostgreSQLDialect

# ==============================================================
# DATABASE CONNECTION POOL (HIKARI) - OPTIMIZED
# ==============================================================
spring.datasource.hikari.connection-timeout=30000
spring.datasource.hikari.idle-timeout=600000
# âœ… CHANGED: Reduced to 10 mins (600000ms) to prevent stale connection errors
spring.datasource.hikari.max-lifetime=600000
spring.datasource.hikari.keepalive-time=200000
spring.datasource.hikari.minimum-idle=5
spring.datasource.hikari.connection-test-query=SELECT 1

# --- SpringDoc OpenAPI (Swagger) Configuration ---
springdoc.swagger-ui.path=/swagger-ui.html
springdoc.api-docs.path=/api-docs

# --- Common AWS & Application Logic ---
aws.region=ap-south-1
tagging.compliance.required-tags=cost-center,project
rightsizing.instance-size-order=nano,micro,small,medium,large,xlarge,2xlarge,4xlarge,8xlarge,12xlarge,16xlarge,24xlarge
quotas.key-codes=L-1216C47A,L-F678F1CE,L-7295265B,L-69A177A2
pricing.ebs.fallback-price=0.10

# --- Rate Limiting for Dashboard API ---
bucket4j.filters[0].url=^/api/dashboard.*
bucket4j.filters[0].rate-limit.bandwidths[0].capacity=10
bucket4j.filters[0].rate-limit.bandwidths[0].time=1
bucket4j.filters[0].rate-limit.bandwidths[0].unit=minutes

# --- Default Redis Port (can be overridden by profiles) ---
spring.redis.port=6379

# --- General Settings ---
spring.security.debug=false
spring.mvc.async.request-timeout=120000
server.servlet.session.timeout=1d
server.servlet.session.cookie.path=/

spring.mail.host=smtp.gmail.com
spring.mail.port=587
spring.mail.username=notifications@xamops.com
spring.mail.password=biph daxm lnjt imer
spring.mail.properties.mail.smtp.auth=true
spring.mail.properties.mail.smtp.starttls.enable=true

app.s3.bucket-name=xamops-document-bucket
app.s3.region=ap-south-1

# AutoSpotting Configuration
autospotting.enabled=true
# The name of the DynamoDB table from the Main Stack Output (CustomerAccountsTableName)
autospotting.dynamodb.table-name=autospotting-CustomerAccounts
# The default tag key/value configured in your Main Stack parameters
autospotting.tag.key=spot-enabled
autospotting.tag.value=true
# The namespace used by AutoSpotting for metrics (Default is usually 'AutoSpotting')
autospotting.metric.namespace=AutoSpotting

# AutoSpotting API Configuration
autospotting.api.base-url=https://do0ezmdybge0h.cloudfront.net/api
autospotting.api.key=sHX4wpgTYZhdBI8LxrM8lhkY8eFgsIg2

cloudformation.s3.bucket=xamops-cloudformation-templates
cloudformation.s3.region=ap-south-1

logging.level.com.fasterxml.jackson=DEBUG
spring.jackson.deserialization.fail-on-unknown-properties=false
spring.jackson.serialization.write-dates-as-timestamps=false
# XamOps AI Configuration (AnythingLLM)
# ==============================================================
# 1. Your API Key
anythingllm.api.key=8KFYS8C-Z2H4JMB-GHY2V1D-JK7YFGD

# 2. The Connection URL for 'xamops-workspace'
# NOTE: We added '/api/v1' and '/chat' to the URL. This is required for the code to work.
anythingllm.url=http://13.200.255.73:3001/api/v1/workspace/xamops-workspace/chat
# Increase timeout to 5 minutes (300,000 ms)
spring.http.client.read-timeout=300s
rest.template.read-timeout=300000
anythingllm.url=http://13.200.255.73:3001/api/v1/workspace/xamops-workspace/chat
